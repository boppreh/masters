\section{Introduction}

For this work it is necessary to have a detailed understanding of finite fields, and how they implemented as primitives for higher level cryptographic structures. Here we focus on a specific type of field, polynomial fields. Furthermore, out of the possible representations we narrow our research to polynomial basis.

Finite fields have numerous applications in cryptography. We are mostly concerned with its use as low level primitive, and the performance of its arithmetic operations. One example of area that is benefited from this research is Elliptic Curve Cryptography, where the point computations are performed on fields such as the ones presented here.

This chapter is an introduction to the concepts that we will build upon. In Section~\ref{background:finite_fields} we explain the very basics of finite fields, trying to build an intuition of the structures involved. In Section~\ref{background:polynomial_representation} we focus on fields constructed from polynomials, and how to represent them. Section~\ref{background:arithmetic} explains the basics of arithmetic on binary polynomial basis, with some useful properties. Finally, in Section~\ref{background:binary} details where and how this type of arithmetic is used in practice.

\section{Finite fields} \label{background:finite_fields}

A Finite Field $\F_{p^m}$ (also known as Galois Field $GF(p^m)$) is an abstract mathematical structure composed of a set of elements and two operators:

\begin{gather*}
\F_{p^m} = (\{A_0, A_1, A_2, ... A_{p^m-1}\}, +, \cdot),
\end{gather*}

where:

\begin{itemize}
\item $\F_{p^m}$: is a finite field of size $p^m$, where:
    \begin{itemize}
    \item $p$: the \emph{field characteristic}, $p \in \mathbb{P}$ (i.e. must be a prime number);
    \item $m$: the \emph{extension size} $m \in \mathbb{N^*}$ (i.e. $m \geq 1,~m$ integer);
    \end{itemize}
\item $\{A_0, A_1, A_2, ... A_{p^m-1}\}$: is a set of $p^m$ \emph{field elements}. In this work we use the letters $A$, $B$ and $C$ to refer to arbitrary members of this set, and $\F_{p^m}$ as an informal shorthand for this set (e.g. $A \in \F_{p^m}$).
\item $+, \cdot$~: are addition and multiplication operators, where:
    \begin{itemize}
    \item they are binary operators that operate on field elements, $+, \cdot : (\F_{p^m} \times \F_{p^m}) \mapsto \F_{p^m}$;
    \item there are two elements labeled $0$ and $1$ that behave as the additive and multiplicative identities, $0 \neq 1$, such that $\forall A (A + 0 = A~\wedge~A \cdot 1 = A)$;
    \item both operations commute (i.e. $A + B = B + A$ and $A \cdot B = B \cdot A$) and associate (i.e. $(A + B) + C = A + (B + C)$ and $(A \cdot B) \cdot C = A \cdot (B \cdot C)$);
    \item every element has an additive and a multiplicative inverse, also in the field (i.e. there are elements $-A$ and $A^{-1}$ such that $A + (-A) = 0$ and $A \cdot A^{-1} = 1$);
    \item except the multiplicative identity $0$, which has no multiplicative inverse (i.e. $0^{-1}$ is undefined);
    \end{itemize}
\end{itemize}

All fields of the same size are isomorphic, and therefore a field can be uniquely identified by its size. There are many ways to construct a field, with modular arithmetic being a common one. Finite fields are commonly constructed using integer arithmetic when $m=1$ (e.g. $\F_{13}$) or polynomial modular arithmetic otherwise (e.g. $\F_{2}[x]/(x^7+x^4+1)$.\\

Take for example the field $\F_{13}$ ($p=13,~m=1$). Fields with $m=1$ must have a prime number of elements, and are commonly called \emph{prime fields}. In the case $\F_{13}$, it can be constructed as $(\{0, 1, 2, ... 11, 12\}, +, \cdot)$. In this field, addition and multiplication are the usual operations, but always modulo the field size, $13$. Therefore:

\begin{align*}
5 + 10 &\equiv 2 \mod 13 \\
5 \cdot 4 &\equiv 7 \mod 13 \\
\end{align*}

Subtraction and division are performed using the additive and multiplicative inverses. Subtration is based on values of the format $-A$, where $A + (-A) \equiv 0 \pmod p$ in prime fields. The multiplicative inverse has an analogous property, where $A^{-1}$ is defined by $A \cdot A^{-1} \equiv 1 \mod p$. For example, $5^{-1} = 8 \mod 13$ because $5 \cdot 8 \equiv 1 \mod 13$. With these two definitions it's possible to define subtraction as $A - B = A + (-B)$, and division as $A / B = A \cdot B^{-1}$.

\section{Polynomial representation} \label{background:polynomial_representation}

For finite fields $\F_{p^m}$ with $m > 1$, one possible structure is to use polynomials of degree $<m$, where coefficients in $\F_{p}$. For instance, the element $A$ can be represented as $\sum_{i=0}^{m-1} a_i x^i,~a_i \in \F_{p}$. Then we choose an \emph{irreducible polynomial} $f$, of degree $m$ and coefficients in $\F_{p}$, and results are taken modulo $f$.\\

The concept of irreducible polynomials is analogous to the primality of integers. A polynomial is \emph{irreducible} if it has degree larger than $2$, and cannot be factored into the product of two other polynomials of degree larger than $2$. It can be thought as a polynomial with no non-trivial divisors.\\

The standard notation for fields using modular arithmetic with irreducible polynomials is $\F_p[x]/f$, where $\F_p[x]$ represents polynomials with coefficients in $\F_p$ and variable $x$, while $/f$ means that operations are performed modulo the irreducible polynomial $f$. As an example of a polynomial representation, the field $\F_{2^7}$ ($p=2,~m=7$) can be constructed as:

\begin{gather*}
\F_{2}[x]/(x^7+x^4+1) = (\{0, 1, x, x+1, x^2, x^2+1, x^2+x, \\
\hspace{8mm} \ldots~, x^6+x^5+x^4+x^3+x^2+x+1\}, +, \cdot)
\end{gather*}

In this case, addition is performed as usual for polynomials, but with the coefficients in $\F_2$:

$$(x^2+x+1) + (x+1) = (x^2+2x+2) \equiv (x^2)$$.

Note that no modulo operation, or \emph{reduction}, is required for additions. This is because the degree of $A+B$ is at most the of $A$ or the degree of $B$. Multiplications, on the other hand, may require reduction modulo $f$ (e.g. $f=x^7+x^4+1$ in this example):

$$(x^4+1) \cdot (x^3+x^2+x+1) \equiv (x^6+x^5+x^3+x^2+x) \mod (x^7+x^4+1)$$.

\section{Arithmetic in finite fields} \label{background:arithmetic}

The choice irreducible polynomial doesn't affect the algebraic structure, since it is isomorphic to any other representations of $\F_{p^m}$. However, certain polynomials have properties that may lead to simplifications in the field operations, making them of high interest for fast implementation in hardware or software.\\

In this work, we focus on polynomial representations of finite fields, with $p=2$ unless noted (e.g. $\F_{2^m}$). They are specially interesting for computations because the coefficients can be thought of as bits, and each element as an array of their coefficients. For example, for an arbitrary element $A$ we can represent it as a sequence of bits with the following notation:

\begin{align*}
A(x) &= x^6+x^3+x \\
& = 1x^6+0x^5+0x^4+1x^3+0x^2+1x+0\\
& \rightarrow [1, 0, 0, 1, 0, 1, 0] \\
\\
A &= [a_{m-1}, a_{m-2}, ..., a_2, a_1, a_0] \\
\end{align*}.

This representation is named \emph{polynomial basis}. In this view, a field addition is just a bitwise XOR operation. For example, the addition of two polynomials $(x^5+x^2)+(x^2+1)$:

\begin{gather*}
(x^5+x^2)+(x^2+1) \rightarrow [0, 1, 0, 0, 1, 0, 0] \oplus [0, 0, 0, 0, 1, 0, 1] \\
= [0, 1, 0, 0, 0, 0, 0],
\end{gather*}

and a multiplication can be performed by a regular polynomial multiplication followed, if needed, by a reduction operation. This $\texttt{reduce}_f$ function takes a "double wide" polynomial (because the resulting degree can be up to $2m-2$), which is not reduced representation of a field element, and returns the reduced representation (the product):

\begin{gather*}
C = A \cdot B\\
D \equiv C \mod f\\
\\
(x^6+1) \cdot (x^3+x^2+x+1) = x^9 + x^8 + x^7 + x^6 + x^3 + x^2 + x + 1 \\
\texttt{reduce}_f([0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1]) \rightarrow [0, 1, 0, 1, 1, 1, 1, 0]\\
\equiv x^6 + x^4 + x^3 + x^2 + x \mod x^7+x^4+1
\end{gather*}

This function, $\texttt{reduce}(C, x^m+...+1) = D$ is the main focus of this work, as it is generalized and used for efficient exponentiations.


\section{NIST Polynomials and their costs}

NIST Binary Polynomials and their costs (Guide to Elliptic Curve Crytography - Hankerson - page 76

\begin{itemize}
\item $x^{163} + x^7 + x^6 + x^3 + 1$ - $C[0..10]$, 41 XORs, 36 SHIFTs, 1 AND = 78 operations
\item $x^{233} + x^{74} + 1$ - $C[0..15!]$, 35 XORs, 35 SHIFTs, 1 AND = 71 operations
\item $x^{283} + x^{12} + x^7 + x^5 + 1$ - $C[0..17]$, 76 XORs, 76 SHIFTs, 1 AND = 153 operations
\item $x^{409} + x^{87} + 1$ - $C[0..25]$, 54 XORs, 54 SHIFTs, 1 AND = 109 operations
\item $x^{571} + x^{10} + x^5 + x^2 + 1$ - $C[0..35]$, 148 XORs, 148 SHIFTs, 1 AND = 297 operations
\end{itemize}


Pentanomials of same degree from the family $x^{b+2c} + x^{b+c} + x^b + x^c + 1$

\begin{itemize}
\item $x^{233} + x^{158} + x^{83} + x^{74} + 1$, score 3.717, $k_a=4$
\item $x^{163} + x^{117} + x^{71} + x^{46} + 1$, score 3.982, $k_a=4$
\item $x^{409} + x^{294} + x^{179} + x^{115} + 1$, score 4.015, $k_a=4$
\item $x^{409} + x^{337} + x^{265} + x^{72} + 1$, score 4.457, $k_a=6$
\item $x^{233} + x^{217} + x^{201} + x^{16} + 1$, score 7.240, $k_a=15$
\item ??571??
\end{itemize}

% TODO: referÃªncias.